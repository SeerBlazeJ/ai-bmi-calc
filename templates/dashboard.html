{% extends "base.html" %}
{% block header %}Health Dashboard{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h4>Welcome, {{ session['username'] }}</h4>
    <a href="{{ url_for('logout') }}" class="btn btn-secondary">
        <i class="fas fa-sign-out-alt"></i> Logout
    </a>
</div>

<div class="top-dashboard mb-4">
    <div class="left-column">
        <!-- BMI Tracker -->
        <div class="dashboard-card card-bmi h-100">
            <h5><i class="fas fa-calculator me-2"></i> BMI Tracker</h5>
            {% if latest_bmi %}
            <div class="text-center my-auto">
                <div class="bmi-value display-2 fw-bold">{{ latest_bmi.bmi }}</div>
                <span class="bmi-category badge {{ latest_bmi.category|lower }}">{{ latest_bmi.category }}</span>
            </div>
            <div class="health-insight text-center small mt-3">
                <p class="mb-1">Recorded on {{ latest_bmi.created_at.strftime('%B %d, %Y') }}</p>
                <p class="mb-0">Weight: {{ latest_bmi.weight }}kg | Height: {{ latest_bmi.height }}cm</p>
            </div>
            {% else %}
            <div class="health-insight text-center my-auto">
                <i class="fas fa-exclamation-triangle fa-2x text-muted mb-3"></i>
                <h6>No Data Available</h6>
                <p class="mb-0 small">Calculate your BMI to get started!</p>
            </div>
            {% endif %}
            <div class="d-grid gap-2 mt-3">
                <a href="{{ url_for('calculator') }}" class="btn btn-sm btn-primary"><i
                        class="fas fa-plus-circle me-2"></i> Add New Record</a>
            </div>
        </div>
    </div>
    <div class="right-column">
        <!-- Today's Health Tip -->
        <div class="dashboard-card card-tip mb-4">
            <h5><i class="fas fa-lightbulb me-2"></i> Today's Health Tip</h5>
            <div class="health-insight mt-3">
                {% if latest_bmi %}
                {% if latest_bmi.category == "Underweight" %}
                <h6><i class="fas fa-arrow-up me-2"></i> Focus on Nutrient-Dense Foods</h6>
                <p class="mb-0 small">Incorporate foods like avocados, nuts, and lean proteins to support healthy weight
                    gain and muscle development.</p>
                {% elif latest_bmi.category == "Normal" %}
                <h6><i class="fas fa-check-circle me-2"></i> Maintain a Balanced Lifestyle</h6>
                <p class="mb-0 small">You're doing great! Continue to focus on a balanced diet and regular physical
                    activity to maintain your health.</p>
                {% elif latest_bmi.category == "Overweight" %}
                <h6><i class="fas fa-walking me-2"></i> Stay Active and Mindful</h6>
                <p class="mb-0 small">Incorporate more movement into your day, like brisk walks, and practice mindful
                    eating to support your goals.</p>
                {% else %}
                <h6><i class="fas fa-heartbeat me-2"></i> Prioritize Sustainable Habits</h6>
                <p class="mb-0 small">Focus on making in darkmode's graph for progress in progress.html, the graphshould
                    be of grey colour in darkmode and of dark grey in light modesmall, sustainable changes to your diet
                    and exercise routine. Consistency is key.</p>
                {% endif %}
                {% else %}
                <h6><i class="fas fa-star me-2"></i> Get Started on Your Journey</h6>
                <p class="mb-0 small">Calculate your BMI to receive personalized health tips and unlock your full
                    dashboard experience.</p>
                {% endif %}
            </div>
        </div>
        <!-- Preferences -->
        <div class="dashboard-card action-card card-preferences">
            <h5><i class="fas fa-sliders-h me-2"></i> Preferences</h5>
            <p class="small text-secondary my-auto">Personalize your meal plans and workout schedules <br> by setting
                your dietary needs, fitness goals, and more.</p>
            <a href="{{ url_for('preferences') }}" class="btn btn-sm btn-primary mt-3"><i
                    class="fas fa-arrow-right me-1"></i> Set Preferences</a>
        </div>
    </div>
</div>

<div class="dashboard-grid">
    <!-- AI Meal Plan -->
    <div class="dashboard-card action-card card-meal">
        <div class="action-card-icon"><i class="fas fa-utensils"></i></div>
        <h5>AI Meal Plan</h5>
        <p class="small text-secondary">Personalized meal plans.</p>
        <a href="{{ url_for('meal_plan') }}" class="btn btn-sm btn-primary mt-auto"><i
                class="fas fa-arrow-right me-1"></i> View</a>
    </div>

    <!-- AI Workout Plan -->
    <div class="dashboard-card action-card card-workout">
        <div class="action-card-icon"><i class="fas fa-dumbbell"></i></div>
        <h5>AI Workout Plan</h5>
        <p class="small text-secondary">Custom workout schedules.</p>
        <a href="{{ url_for('workout_plan') }}" class="btn btn-sm btn-primary mt-auto"><i
                class="fas fa-arrow-right me-1"></i> View</a>
    </div>

    <!-- Progress Analytics -->
    <div class="dashboard-card action-card card-analytics">
        <div class="action-card-icon"><i class="fas fa-chart-area"></i></div>
        <h5>Progress Analytics</h5>
        <p class="small text-secondary">Visualize your trends.</p>
        <a href="{{ url_for('progress') }}" class="btn btn-sm btn-primary mt-auto"><i
                class="fas fa-arrow-right me-1"></i> View</a>
    </div>

    <!-- Kinetic Edge Assistant -->
    <div class="dashboard-card action-card card-assistant">
        <div class="action-card-icon"><i class="fas fa-robot"></i></div>
        <h5>Kinetic Edge Assistant</h5>
        <p class="small text-secondary">Chat with our AI health coach.</p>
        <a href="{{ url_for('chat') }}" class="btn btn-sm btn-primary mt-auto"><i class="fas fa-arrow-right me-1"></i>
            Chat</a>
    </div>
</div>

<style>
    .top-dashboard {
        display: flex;
        gap: 1.5rem;
    }

    .left-column {
        flex: 1;
    }

    .right-column {
        flex: 2;
        display: flex;
        flex-direction: column;
    }

    .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 1.5rem;
    }

    .dashboard-card {
        background: var(--card-bg);
        border-radius: 1rem;
        padding: 1.5rem;
        border: 1px solid var(--border-color);
        box-shadow: var(--shadow-sm);
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
    }

    .dashboard-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-lg);
    }

    @media (max-width: 992px) {
        .top-dashboard {
            flex-direction: column;
        }

        .dashboard-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 576px) {
        .dashboard-grid {
            grid-template-columns: 1fr;
        }
    }

    .bmi-value {
        color: var(--primary-color);
    }

    .bmi-category {
        font-size: 1rem;
        padding: 0.5em 1em;
    }

    .badge.underweight {
        background-color: #6c757d;
    }

    .badge.normal {
        background-color: #28a745;
    }

    .badge.overweight {
        background-color: #ffc107;
    }

    .badge.obese {
        background-color: #dc3545;
    }

    .action-card {
        align-items: center;
        text-align: center;
    }

    .action-card-icon {
        font-size: 2.5rem;
        color: var(--primary-color);
        margin-bottom: 1rem;
    }

    .action-card h5 {
        font-weight: 600;
        margin-bottom: 0.5rem;
    }
</style>
{% endblock %}